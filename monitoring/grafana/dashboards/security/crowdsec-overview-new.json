{
  "id": 17,
  "panels": [
    {
      "datasource": {
        "type": "prometheus",
        "uid": "fej0f94ejiq68f"
      },
      "description": "Total number of IPs currently banned by CrowdSec. Yellow indicates moderate attack activity (>1000), red indicates heavy attacks (>5000).",
      "fieldConfig": {
        "defaults": {
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "yellow",
                "value": 1000
              },
              {
                "color": "red",
                "value": 5000
              }
            ]
          }
        }
      },
      "gridPos": {
        "h": 4,
        "w": 4,
        "x": 0,
        "y": 0
      },
      "id": 1,
      "options": {
        "colorMode": "background",
        "graphMode": "area",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ]
        }
      },
      "targets": [
        {
          "expr": "sum(cs_active_decisions{action=\"ban\"})",
          "refId": "A"
        }
      ],
      "title": "Active Bans",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "fej0f94ejiq68f"
      },
      "description": "Number of CrowdSec agents currently running. Red if 0 means the security service is down and no protection is active.",
      "fieldConfig": {
        "defaults": {
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "red",
                "value": null
              },
              {
                "color": "green",
                "value": 1
              }
            ]
          }
        }
      },
      "gridPos": {
        "h": 4,
        "w": 4,
        "x": 4,
        "y": 0
      },
      "id": 2,
      "options": {
        "colorMode": "background",
        "graphMode": "none",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ]
        }
      },
      "targets": [
        {
          "expr": "count(cs_info)",
          "refId": "A"
        }
      ],
      "title": "CrowdSec Instances",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "fej0f94ejiq68f"
      },
      "description": "Total requests from the Traefik bouncer to the CrowdSec LAPI asking 'is this IP banned?'. High numbers correlate with your web traffic volume.",
      "fieldConfig": {
        "defaults": {
          "unit": "short"
        }
      },
      "gridPos": {
        "h": 4,
        "w": 4,
        "x": 8,
        "y": 0
      },
      "id": 3,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ]
        }
      },
      "targets": [
        {
          "expr": "sum(cs_lapi_bouncer_requests_total)",
          "refId": "A"
        }
      ],
      "title": "Bouncer Requests",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "fej0f94ejiq68f"
      },
      "description": "Total log lines that CrowdSec has successfully parsed and analyzed. This shows how much traffic data has been processed for threat detection.",
      "fieldConfig": {
        "defaults": {
          "unit": "short"
        }
      },
      "gridPos": {
        "h": 4,
        "w": 4,
        "x": 12,
        "y": 0
      },
      "id": 4,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ]
        }
      },
      "targets": [
        {
          "expr": "sum(cs_parser_hits_total)",
          "refId": "A"
        }
      ],
      "title": "Log Lines Parsed",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "fej0f94ejiq68f"
      },
      "description": "Raw log lines read from Traefik log files before parsing. Should be close to 'Log Lines Parsed' - a big gap indicates parsing errors.",
      "fieldConfig": {
        "defaults": {
          "unit": "short"
        }
      },
      "gridPos": {
        "h": 4,
        "w": 4,
        "x": 16,
        "y": 0
      },
      "id": 5,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ]
        }
      },
      "targets": [
        {
          "expr": "sum(cs_filesource_hits_total)",
          "refId": "A"
        }
      ],
      "title": "File Source Hits",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "fej0f94ejiq68f"
      },
      "description": "Requests per minute that were checked and ALLOWED (no ban found). This is normal traffic - IPs checked by the bouncer that have no active ban decision against them.",
      "fieldConfig": {
        "defaults": {
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "short",
          "decimals": 1
        }
      },
      "gridPos": {
        "h": 4,
        "w": 4,
        "x": 20,
        "y": 0
      },
      "id": 6,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ]
        }
      },
      "targets": [
        {
          "expr": "sum(rate(cs_lapi_decisions_ko_total[5m])) * 60 or vector(0)",
          "refId": "A"
        }
      ],
      "title": "Allowed Requests/min",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "fej0f94ejiq68f"
      },
      "description": "Breakdown of active bans by the attack scenario that triggered them. Common reasons include http-bad-user-agent, http-probing, and ssh-bf (brute force).",
      "gridPos": {
        "h": 8,
        "w": 8,
        "x": 0,
        "y": 4
      },
      "id": 7,
      "options": {
        "legend": {
          "displayMode": "table",
          "placement": "right",
          "showLegend": true
        },
        "pieType": "pie",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ]
        }
      },
      "targets": [
        {
          "expr": "cs_active_decisions{action=\"ban\"}",
          "legendFormat": "{{reason}}",
          "refId": "A"
        }
      ],
      "title": "Active Decisions by Reason",
      "type": "piechart"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "fej0f94ejiq68f"
      },
      "description": "Where the ban decisions came from. 'capi' = CrowdSec community blocklist (shared threat intelligence), 'crowdsec' = detected locally by your instance.",
      "gridPos": {
        "h": 8,
        "w": 8,
        "x": 8,
        "y": 4
      },
      "id": 8,
      "options": {
        "legend": {
          "displayMode": "table",
          "placement": "right",
          "showLegend": true
        },
        "pieType": "pie",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ]
        }
      },
      "targets": [
        {
          "expr": "sum(cs_active_decisions) by (origin)",
          "legendFormat": "{{origin}}",
          "refId": "A"
        }
      ],
      "title": "Active Decisions by Origin",
      "type": "piechart"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "fej0f94ejiq68f"
      },
      "description": "Type of action taken against threats. 'ban' = block completely, 'captcha' = challenge with CAPTCHA, 'throttle' = rate limit the connection.",
      "gridPos": {
        "h": 8,
        "w": 8,
        "x": 16,
        "y": 4
      },
      "id": 9,
      "options": {
        "legend": {
          "displayMode": "table",
          "placement": "right",
          "showLegend": true
        },
        "pieType": "pie",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ]
        }
      },
      "targets": [
        {
          "expr": "sum(cs_active_decisions) by (action)",
          "legendFormat": "{{action}}",
          "refId": "A"
        }
      ],
      "title": "Decisions by Action Type",
      "type": "piechart"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "fej0f94ejiq68f"
      },
      "description": "Historical view of active bans over time, grouped by attack scenario. Spikes indicate attack waves; use this to identify patterns and peak attack times.",
      "fieldConfig": {
        "defaults": {
          "custom": {
            "drawStyle": "line",
            "fillOpacity": 20,
            "stacking": {
              "mode": "normal"
            }
          }
        }
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 12
      },
      "id": 10,
      "options": {
        "legend": {
          "displayMode": "list",
          "placement": "bottom"
        }
      },
      "targets": [
        {
          "expr": "cs_active_decisions{action=\"ban\"}",
          "legendFormat": "{{reason}}",
          "refId": "A"
        }
      ],
      "title": "Active Bans Over Time",
      "type": "timeseries"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "fej0f94ejiq68f"
      },
      "description": "Rate of requests per second from Traefik bouncer to CrowdSec LAPI. This correlates with your incoming web traffic - each request checks if an IP should be blocked.",
      "fieldConfig": {
        "defaults": {
          "custom": {
            "drawStyle": "line",
            "fillOpacity": 10
          },
          "unit": "reqps"
        }
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 12
      },
      "id": 11,
      "options": {
        "legend": {
          "displayMode": "list",
          "placement": "bottom"
        }
      },
      "targets": [
        {
          "expr": "rate(cs_lapi_bouncer_requests_total[5m])",
          "legendFormat": "{{bouncer}} - {{route}}",
          "refId": "A"
        }
      ],
      "title": "Bouncer Request Rate",
      "type": "timeseries"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "fej0f94ejiq68f"
      },
      "description": "Rate of log lines being parsed per second from each source. Should be steady during normal operation; drops indicate log ingestion problems.",
      "fieldConfig": {
        "defaults": {
          "custom": {
            "drawStyle": "bars",
            "fillOpacity": 80
          },
          "unit": "short"
        }
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 20
      },
      "id": 12,
      "options": {
        "legend": {
          "displayMode": "list",
          "placement": "bottom"
        }
      },
      "targets": [
        {
          "expr": "rate(cs_parser_hits_total[5m])",
          "legendFormat": "{{source}}",
          "refId": "A"
        }
      ],
      "title": "Parser Hits Rate",
      "type": "timeseries"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "fej0f94ejiq68f"
      },
      "description": "Average response time of the CrowdSec Local API by endpoint. High latency here can slow down Traefik as it waits for ban decisions.",
      "fieldConfig": {
        "defaults": {
          "custom": {
            "drawStyle": "line",
            "fillOpacity": 10
          },
          "unit": "s"
        }
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 20
      },
      "id": 13,
      "options": {
        "legend": {
          "displayMode": "list",
          "placement": "bottom"
        }
      },
      "targets": [
        {
          "expr": "rate(cs_lapi_request_duration_seconds_sum[5m]) / rate(cs_lapi_request_duration_seconds_count[5m])",
          "legendFormat": "{{endpoint}}",
          "refId": "A"
        }
      ],
      "title": "LAPI Response Time",
      "type": "timeseries"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "fej0f94ejiq68f"
      },
      "description": "Top 10 most common attack scenarios currently resulting in bans. Shows which types of attacks are most prevalent against your infrastructure.",
      "fieldConfig": {
        "defaults": {
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "blue",
                "value": null
              },
              {
                "color": "yellow",
                "value": 500
              },
              {
                "color": "red",
                "value": 1000
              }
            ]
          }
        }
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 28
      },
      "id": 14,
      "options": {
        "displayMode": "gradient",
        "orientation": "horizontal",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ]
        }
      },
      "targets": [
        {
          "expr": "topk(10, cs_active_decisions{action=\"ban\"})",
          "legendFormat": "{{reason}}",
          "refId": "A"
        }
      ],
      "title": "Top Attack Types",
      "type": "bargauge"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "fej0f94ejiq68f"
      },
      "description": "Information about running CrowdSec instances including version, hostname, and job name. Useful for verifying your security stack is up to date.",
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 28
      },
      "id": 15,
      "options": {
        "showHeader": true
      },
      "targets": [
        {
          "expr": "cs_info",
          "format": "table",
          "instant": true,
          "refId": "A"
        }
      ],
      "title": "CrowdSec Info",
      "transformations": [
        {
          "id": "organize",
          "options": {
            "excludeByName": {
              "Time": true,
              "Value": true,
              "__name__": true
            },
            "renameByName": {
              "instance": "Instance",
              "job": "Job",
              "version": "Version"
            }
          }
        }
      ],
      "type": "table"
    }
  ],
  "refresh": "30s",
  "schemaVersion": 41,
  "tags": [
    "crowdsec",
    "security"
  ],
  "time": {
    "from": "now-6h",
    "to": "now"
  },
  "timezone": "browser",
  "title": "CrowdSec Overview",
  "uid": "crowdsec-overview-new",
  "version": 1
}
